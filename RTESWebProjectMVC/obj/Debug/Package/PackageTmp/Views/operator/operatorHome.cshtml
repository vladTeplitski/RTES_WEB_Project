<div class="container-fluid" ng-controller="operatorController">

    <!--START Operator Page-->
    

    <div class="row bodyRow operatorWindow">
        
        <!-- Start Operator buttons -->
            <div ng-hide="btnPanel" class="col-lg-3 col-lg-offset-1 col-md-4 col-md-offset-0 col-xs-8 col-xs-offset-2 opButtonsCont1">
                <div class="getStartedBox" style="position: relative; margin-top: 8px; margin-bottom: 8px;">

                    <div ng-click="operatorClick(3)" onclick="setRefreshes()" class="btnInfo">
                        <div style="display: inline; position: absolute; left: 8px;"><i class="glyphicon glyphicon-folder-open"></i></div>
                        Operations Room
                    </div>

                    <div ng-click="operatorClick(1)" class="btnInfo">
                        <div style="display: inline; position: absolute; left: 8px;"><i class="glyphicon glyphicon-folder-open"></i></div>
                        Reports Library
                    </div>

                    <div ng-click="operatorClick(2)" class="btnInfo">
                        <div style="display: inline; position: absolute; left: 8px;"><i class="glyphicon glyphicon-pencil"></i></div>
                        Users Management
                    </div>
                </div>
            </div>
        <!-- END Operator buttons -->


        <!-- Start operations room buttons -->
        <div>
            <div ng-hide="btnPanel2" class="getStartedBoxOp" style="margin-top: 5px; margin-bottom: 5px;display:inline;">

                <div ng-click="operatorClick(1)" onclick="hideOperations(); stopRefresh()" class="btnInfo" style="margin-left:10%;width:200px;float:left">
                    <div style="margin-right:3px;display: inline;"><i class="glyphicon glyphicon-folder-open"></i></div>
                    Reports Library
                </div>

                <div ng-click="operatorClick(2)" onclick="hideOperations(); stopRefresh()" class="btnInfo" style="margin-left:5px;width:200px;float:left">
                    <div style="margin-right:3px;display: inline;"><i class="glyphicon glyphicon-pencil"></i></div>
                    Users Management
                </div>

                <div style="clear:both;border:none;height:0px;margin:0px"></div>

            </div>
        </div>
        <!-- END operations room buttons -->


        <!--Start Operations Room -->
        
        <div id="opsContain">
            <div ng-hide="oper3" class="col-lg-12 OperationsContainer">

                @Html.Partial("operationsPartial");

            </div>
        </div>

        <div id="opsContainPartials"></div>



        <!--END Operations Room -->

    

            <div class="col-lg-6 col-lg-offset-1 col-md-6 col-md-offset-1 col-xs-12">

                <!--Notifications-->
                <div class="notifBox msgANorifGui" style="display:@ViewBag.showCommentNotifGui">
                    <div class="infoFormHeader">
                        System Notification
                        <div class="CloseMsgNotif x">x</div>
                    </div>
                    <div style="margin-top:20px;margin-bottom:20px;margin-left:6px;">
                        Report number: @ViewBag.sentId<br />
                        Comment was set successfully!
                    </div>
                </div>

                <div style="margin: 3px auto; text-align: center; padding: 8px 0px">
                    <div class="opMobileDeviceAlert alert alert-danger panelDanger" ID="pnlMessage">
                        Operator panel is not available on your device.
                    </div>
                </div>

                <div class="notifBox msgANorifGui" style="display:@ViewBag.showMsgANorifGui">
                    <div class="infoFormHeader">
                        System Notification
                        <div class="CloseMsgNotif x">x</div>
                    </div>
                    <div style="margin-top:20px;margin-bottom:20px;margin-left:6px;">
                        Message to:
                        <ul>
                            <li>@ViewBag.sentName</li>
                            <li>@ViewBag.sentId</li>
                        </ul>
                        Sent Successfully !
                    </div>
                </div>
        
                <div id="opsRoomNotif" class="successNotif" style="display:@ViewBag.showClosedReportOpsNotif">
                    <div class="successNotifHeader">
                        <b><i Style="font-size:15px;margin-right:5px;" class="glyphicon glyphicon-ok"></i>Notfication</b>
                        <div onclick="hideClosedRepNotif()" class="x">x</div>
                    </div>

                    <br />
                    <b>Report closed successfully!</b>
                    <br />
                </div>        
        
                <!--END notifications-->

                <div class="mainWindow2">

                    <!--Start Operator home window-->
                    <div ng-hide="oper0" class="textContainer">
                        Welcome to operator portal.
                        <!--Tests-->

                        <!--End Tests-->
                        </div>

                     <!--notification - Changes by operator-->
                    <div id="operatorNotification" class="successNotif" style="display:@ViewBag.showOpNotif">
                    <div class="successNotifHeader">
                        <b><i Style="font-size:15px;margin-right:5px;" class="glyphicon glyphicon-ok"></i>Notfication</b>
                        <div onclick="closeViewOpNotif()" class="x">x</div>
                    </div>
                    <br />
                    <b>Settings Edited Successfully.</b>
                    </div>
                    <!--END notification-->


                    <!--Start Existing reports in system -->
                    <div ng-hide="oper1" class="textContainer" style="overflow:auto;">

                        <div id="reportsInSystem" class="personalDetailsClass" Style="background-color:#4786BD;border-color:#5E97C9">
                            <i Style="font-size:23px;" class="glyphicon glyphicon-list-alt"></i>
                            <span style="margin-left:10px;">Reports Database</span>
                        </div>

                        <div style="width: 50%; margin: 3px auto; text-align: center; padding: 8px 0px; display:@ViewBag.allReportsFromDbAlert">
                            <Div Class="alert alert-danger" ID="msgAlert1">
                                No reports found in database!
                            </Div>
                        </div>


                        <div class="personalDetailsClass" toolstyle="toolcssBottom" toolinfo="Search Report" tooltip>
                            <i Style="margin-right:10px;font-size:23px;" class="glyphicon glyphicon-search"></i>
                            <input type="text" class="form-control" id="repInput1" style="color:black;width:190px;display:inline;" onkeyup="searchAllReportsByIdJs()" placeholder="Report ID">
                            <input type="text" class="form-control formLowRes" id="repInput2" style="color:black;width:190px;display:inline;" onkeyup="searchAllReportsByClientIdJs()" placeholder="Client ID">
                        </div>

                        <div id="Div2" class="personalDetailsClass">
                            <i Style="font-size:19px;" class="glyphicon glyphicon-th-list"></i>
                            <span style="margin-left:10px;margin-bottom:5px;">Reports List</span>

                            <br />

                            <div class="UserListContainer">

                                <table id="allReportsTable" class="table table - striped" style="font-size:small;">
                                    <tr>
                                        <th>Report ID</th>
                                        <th>Status</th>
                                        <th>Date</th>
                                        <th>Client ID</th>
                                    </tr>

                                    @{

                                        if (ViewBag.allReportsDB != null)
                                        {
                                            foreach (var item in ViewBag.allReportsDB)
                                            {

                                                <tr id="updatePannelAngular">
                                                    <td>
                                                        @item.reportID

                                                    </td>
                                                    <td>
                                                        <!--status: 0: open, 1: finished towing - moving to appraising, 2: End appraising -> move to final stage-, 3:closed report-->
                                                        @if(item.status!=3)
                                                        {
                                                            <span style="color:lawngreen;font-size:small">Open</span>
                                                        }
                                                        else
                                                        {
                                                            <span style="color:red;font-size:small">Closed</span>
                                                        }
                                                    </td>
                                                    <td>
                                                        @item.date
                                                    </td>
                                                    <td>
                                                        @item.clientAbstractUserId
                                                    </td>
                                                    <td>
                                                        <ul style="list-style-type: none;">
                                                            <li class="dropdown" style="margin-left:-20px;padding-left:1px;">
                                                                <a toolstyle="toolcssLeft" toolinfo="Menu" tooltip ng-click="$event.preventDefault();" class="dropdown-toggle" data-toggle="dropdown" href="#"><i Style="font-size:20px;" class="glyphicon glyphicon-option-horizontal"></i></a>
                                                                <ul class="dropdown-menu pull-right" style="background-color:#4786BD;border:1px solid #74B2E8;right:0;">
                                                                    <li>@Ajax.ActionLink("View Details", "openReportDetails", "operator", new { id = item.reportID, @class = "button101" }, new AjaxOptions { UpdateTargetId = "reportDest" })</li>
                                                                    <li>@Ajax.ActionLink("Comment", "openCommentGui", "operator", new { id = item.reportID, @class = "button101" }, new AjaxOptions { UpdateTargetId = "reportDest" })</li>
                                                                </ul>
                                                            </li>
                                                        </ul>

                                                    </td>
                                                </tr>
                                            }
                                        }
                                        else
                                        {
                                            <tr id="updatePannelAngular">
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                            </tr>
                                        }

                                    }
                                </table>


                            </div>

                            <!--Partial View-->
                            <div id="reportDest">

                            </div>

                        </div>
                        
                        
                    </div>
                    <!--END Existing reports in system -->


                    <!--Start - Users Management -->
                    <div id="usersMng" ng-hide="oper2" class="textContainer">

                        <div id="Div1" class="personalDetailsClass" Style="background-color:#4786BD;border-color:#5E97C9">
                            <i Style="font-size:23px;" class="glyphicon glyphicon-user"></i>
                            <span style="margin-left:10px;">Users Management</span>
                        </div>

                        <div style="width: 50%; margin: 3px auto; text-align: center; padding: 8px 0px; display:@ViewBag.usersFromDbAlert">
                            <Div Class="alert alert-danger" ID="msgAlert1">
                                No users found in database!
                            </Div>
                        </div>

                        <div class="personalDetailsClass" toolstyle="toolcssBottom" toolinfo="Search User" tooltip>
                            <i Style="margin-right:10px;font-size:23px;" class="glyphicon glyphicon-search"></i>
                            <input type="text" class="form-control" id="myInput" style="color:black;width:190px;display:inline;" onkeyup="searchIdJs()" placeholder="Search for ID...">
                            <input type="text" class="form-control formLowRes" id="myInput2" style="color:black;width:190px;display:inline;" onkeyup="searchNameJs()" placeholder="Search for Name...">
                        </div>

                        <div id="Div2" class="personalDetailsClass">
                            <i Style="font-size:19px;" class="glyphicon glyphicon-th-list"></i>
                            <span style="margin-left:10px;margin-bottom:5px;">Users List</span>

                            <br />

                            <div class="UserListContainer">

                                <table id="myTable" class="table table - striped" style="font-size:small;">
                                    <tr>
                                        <th>User ID</th>
                                        <th>Name</th>
                                        <th>family_name</th>
                                    </tr>

                                    @{

                                        if (ViewBag.usersDB != null)
                                        {
                                            foreach (var item in ViewBag.usersDB)
                                            {

                                                <tr id="updatePannelAngular">
                                                    <td>
                                                        @item.id

                                                    </td>
                                                    <td>
                                                        @item.name
                                                    </td>
                                                    <td>
                                                        @item.familyName
                                                    </td>
                                                    <td>
                                                        <ul style="list-style-type: none;">
                                                            <li class="dropdown" style="margin-left:-20px;padding-left:1px;">
                                                                <a toolstyle="toolcssLeft" toolinfo="Menu" tooltip ng-click="$event.preventDefault();" class="dropdown-toggle" data-toggle="dropdown" href="#"><i Style="font-size:15px;" class="glyphicon glyphicon-menu-hamburger"></i></a>
                                                                <ul class="dropdown-menu pull-right" style="background-color:#4786BD;border:1px solid #74B2E8;right:0;">
                                                                    <li>@Ajax.ActionLink("Details", "openUserDetailsGui", "operator", new { id = item.id, @class = "button101" }, new AjaxOptions { UpdateTargetId = "msgDest" })</li>
                                                                    @if (item.role == "Operator")  // if operator - disable message send
                                                                    {
                                                                        <li ng-click="$event.preventDefault();"><a Style="cursor:default;color:red;" href="#">Message</a></li>
                                                                    }
                                                                    else //enable send message to clients
                                                                    {
                                                                    <li>@Ajax.ActionLink("Message", "openMessageUser", "operator", new { id = item.id, @class = "button101" }, new AjaxOptions { UpdateTargetId = "msgDest" })</li>
                                                                    }
                                                                    <li>@Ajax.ActionLink("Edit", "openEditUserGui", "operator", new { id = item.id, @class = "button101" }, new AjaxOptions { UpdateTargetId = "msgDest" })</li>
                                                                </ul>
                                                            </li>
                                                        </ul>

                                                    </td>
                                                </tr>
                                            }
                                        }
                                        else
                                        {
                                            <tr id="updatePannelAngular">
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                            </tr>
                                        }

                                    }
                                </table>


                            </div>

                            <!--Partial Views-->
                            <div id="msgDest"></div>





                            

                        </div>
                    </div>
                    <!--END - Users Management -->


                </div><!--Main window div-->
            </div><!--bootstrap col content div-->
          </div> <!--End Operator Page-->
    </div><!--Main container-->
